version: '3.8'

services:
  broker:
    container_name: broker-app
    image: dleclercpro/eda-playground-broker:v1.0.0
    build:
      context: ./Apps
      dockerfile: BrokerApp.Dockerfile
    ports:
      - 4000:4000
    networks:
      - app
    environment:
      NODE_ENV: production

  order:
    container_name: order-app
    image: dleclercpro/eda-playground-order:v1.0.0
    build:
      context: ./Apps
      dockerfile: OrderApp.Dockerfile
    networks:
      - app
    depends_on:
      - broker
    environment:
      NODE_ENV: production

  payment:
    container_name: payment-app
    image: dleclercpro/eda-playground-payment:v1.0.0
    build:
      context: ./Apps
      dockerfile: PaymentApp.Dockerfile
    networks:
      - app
    depends_on:
      - broker
    environment:
      NODE_ENV: production

  delivery:
    container_name: delivery-app
    image: dleclercpro/eda-playground-delivery:v1.0.0
    build:
      context: ./Apps
      dockerfile: DeliveryApp.Dockerfile
    networks:
      - app
    depends_on:
      - broker
    environment:
      NODE_ENV: production

networks:
  app:
    driver: bridge